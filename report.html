<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Response</title>

  <link href="assets/full.min.css" rel="stylesheet" type="text/css" />
  <script src="assets/daisyui.js"></script>

</head>

<body class="p-6">
  <div class="container mx-auto">
    <div class="card shadow-lg p-6 rounded-lg">

      <!-- images -->
      <div class="carousel carousel-center rounded-box" id="images">
        <div class="carousel-item">
          <img src="https://img.daisyui.com/images/stock/photo-1559703248-dcaaec9fab78.webp" alt="Pizza" />
        </div>
        <div class="carousel-item">
          <img src="https://img.daisyui.com/images/stock/photo-1565098772267-60af42b81ef2.webp" alt="Pizza" />
        </div>
        <div class="carousel-item">
          <img src="https://img.daisyui.com/images/stock/photo-1572635148818-ef6fd45eb394.webp" alt="Pizza" />
        </div>
        <div class="carousel-item">
          <img src="https://img.daisyui.com/images/stock/photo-1494253109108-2e30c049369b.webp" alt="Pizza" />
        </div>
        <div class="carousel-item">
          <img src="https://img.daisyui.com/images/stock/photo-1550258987-190a2d41a8ba.webp" alt="Pizza" />
        </div>
        <div class="carousel-item">
          <img src="https://img.daisyui.com/images/stock/photo-1559181567-c3190ca9959b.webp" alt="Pizza" />
        </div>
        <div class="carousel-item">
          <img src="https://img.daisyui.com/images/stock/photo-1601004890684-d8cbf643f5f2.webp" alt="Pizza" />
        </div>
      </div>

      <h2 class="text-4xl font-bold mb-4 mt-2" id="title"></h2>

      <div class="mb-4">
                <h3 class="text-1xl text-gray-500 font-semibold" id="description">
                  <div class="skeleton h-4 w-full mb-1"></div>
                  <div class="skeleton h-4 w-full mb-1"></div>
                  <div class="skeleton h-4 w-5/6"></div>
                </h3>
            </div>

            <!-- sources -->
      <div class="mb-4">
        <!-- show favicons of the sources and when clicked axpand and show the link -->
         <div class="inline-flex space-x-2" id="sourceIcons">
          <img src="https://www.google.com/s2/favicons?domain=www.google.com" alt="Google" class="w-6 h-6 rounded-full" />
          <img src="https://www.google.com/s2/favicons?domain=www.google.com" alt="Google" class="w-6 h-6 rounded-full" />
          <img src="https://www.google.com/s2/favicons?domain=www.google.com" alt="Google" class="w-6 h-6 rounded-full" />
          <img src="https://www.google.com/s2/favicons?domain=www.google.com" alt="Google" class="w-6 h-6 rounded-full" />
          <img src="https://www.google.com/s2/favicons?domain=www.google.com" alt="Google" class="w-6 h-6 rounded-full" />

          <!-- arrow button -->
          <button class="btn btn-ghost btn-sm" id="expandSources">Show sources</button>
        </div>
      </div>

        <!-- expanded links, show as smal containers with title; use a carousel -->
        <div class="carousel carousel-center rounded-box mb-4 hidden" id="sources">
          <div class="carousel-item bg-gray-900 p-4 rounded-lg w-48 mx-2">
            <div class="flex flex-col space-y-2">
              <h4 class="font-semibold">Google is a search engine</h4>
              <a href="https://www.google.com" target="_blank" class="text-blue-500 inline-flex"><img src="https://www.google.com/s2/favicons?domain=www.google.com" alt="Google" class="w-5 h-5 rounded-full mr-2" /> google.com</a>
            </div>
          </div>
          <div class="carousel-item bg-gray-900 p-4 rounded-lg w-48 mx-2">
            <div class="flex flex-col space-y-2">
              <h4 class="font-semibold">Google is a search engine</h4>
              <a href="https://www.google.com" target="_blank" class="text-blue-500 inline-flex"><img src="https://www.google.com/s2/favicons?domain=www.google.com" alt="Google" class="w-5 h-5 rounded-full mr-2" /> google.com</a>
            </div>
          </div>
          <div class="carousel-item bg-gray-900 p-4 rounded-lg w-48 mx-2">
            <div class="flex flex-col space-y-2">
              <h4 class="font-semibold">Google is a search engine</h4>
              <a href="https://www.google.com" target="_blank" class="text-blue-500 inline-flex"><img src="https://www.google.com/s2/favicons?domain=www.google.com" alt="Google" class="w-5 h-5 rounded-full mr-2" /> google.com</a>
            </div>
          </div>
      </div>

      <br>

      <!-- answers -->
      <div class="mb-4" id="answers">
        <!-- skeleton -->
        <div class="flex flex-col space-y-2 mb-5">
          <div class="skeleton h-4 w-1/3"></div>
          <div class="skeleton h-4 w-3/4"></div>
          <div class="skeleton h-4 w-4/5"></div>
        </div>
        <div class="flex flex-col space-y-2 mb-5">
          <div class="skeleton h-4 w-1/3"></div>
          <div class="skeleton h-4 w-3/4"></div>
          <div class="skeleton h-4 w-4/5"></div>
        </div>
        <div class="flex flex-col space-y-2 mb-5">
          <div class="skeleton h-4 w-1/3"></div>
          <div class="skeleton h-4 w-3/4"></div>
          <div class="skeleton h-4 w-4/5"></div>
        </div>
      </div>

      <br>

      <div class="mb-4" id="sections">

        <div class="flex flex-col space-y-2 mb-5">
          <div class="skeleton h-4 w-1/2"></div>
          <div class="skeleton h-4 w-5/6"></div>
          <div class="skeleton h-4 w-full"></div>
          <div class="skeleton h-4 w-full"></div>
        </div>
        <div class="flex flex-col space-y-2 mb-5">
          <div class="skeleton h-4 w-1/2"></div>
          <div class="skeleton h-4 w-5/6"></div>
          <div class="skeleton h-4 w-full"></div>
          <div class="skeleton h-4 w-full"></div>
        </div>
        <div class="flex flex-col space-y-2 mb-5">
          <div class="skeleton h-4 w-1/2"></div>
          <div class="skeleton h-4 w-5/6"></div>
          <div class="skeleton h-4 w-full"></div>
          <div class="skeleton h-4 w-full"></div>
        </div>
        <div class="flex flex-col space-y-2 mb-5">
          <div class="skeleton h-4 w-1/2"></div>
          <div class="skeleton h-4 w-5/6"></div>
          <div class="skeleton h-4 w-full"></div>
          <div class="skeleton h-4 w-full"></div>
        </div>
        <div class="flex flex-col space-y-2 mb-5">
          <div class="skeleton h-4 w-1/2"></div>
          <div class="skeleton h-4 w-5/6"></div>
          <div class="skeleton h-4 w-full"></div>
          <div class="skeleton h-4 w-full"></div>
        </div>
      </div>
    </div>
  </div>



  <script>
    const title = document.getElementById('title');
    const description = document.getElementById('description');
    const images = document.getElementById('images');
    const content = document.getElementById('sections');
    const answers = document.getElementById('answers');

    const emojis = {
  ":school_satchel:": "🎒",
  ":mortar_board:": "🎓",
  ":flags:": "🎏",
  ":fireworks:": "🎆",
  ":sparkler:": "🎇",
  ":wind_chime:": "🎐",
  ":rice_scene:": "🎑",
  ":jack_o_lantern:": "🎃",
  ":ghost:": "👻",
  ":santa:": "🎅",
  ":christmas_tree:": "🎄",
  ":gift:": "🎁",
  ":bell:": "🔔",
  ":no_bell:": "🔕",
  ":tanabata_tree:": "🎋",
  ":tada:": "🎉",
  ":confetti_ball:": "🎊",
  ":balloon:": "🎈",
  ":crystal_ball:": "🔮",
  ":cd:": "💿",
  ":dvd:": "📀",
  ":floppy_disk:": "💾",
  ":camera:": "📷",
  ":video_camera:": "📹",
  ":movie_camera:": "🎥",
  ":computer:": "💻",
  ":tv:": "📺",
  ":iphone:": "📱",
  ":phone:": "☎️",
  ":telephone:": "☎️",
  ":telephone_receiver:": "📞",
  ":pager:": "📟",
  ":fax:": "📠",
  ":minidisc:": "💽",
  ":vhs:": "📼",
  ":sound:": "🔉",
  ":speaker:": "🔈",
  ":mute:": "🔇",
  ":loudspeaker:": "📢",
  ":mega:": "📣",
  ":hourglass:": "⌛",
  ":hourglass_flowing_sand:": "⏳",
  ":alarm_clock:": "⏰",
  ":watch:": "⌚",
  ":radio:": "📻",
  ":satellite:": "📡",
  ":loop:": "➿",
  ":mag:": "🔍",
  ":mag_right:": "🔎",
  ":unlock:": "🔓",
  ":lock:": "🔒",
  ":lock_with_ink_pen:": "🔏",
  ":closed_lock_with_key:": "🔐",
  ":key:": "🔑",
  ":bulb:": "💡",
  ":flashlight:": "🔦",
  ":high_brightness:": "🔆",
  ":low_brightness:": "🔅",
  ":electric_plug:": "🔌",
  ":battery:": "🔋",
  ":calling:": "📲",
  ":email:": "📧",
  ":mailbox:": "📫",
  ":postbox:": "📮",
  ":bath:": "🛀",
  ":bathtub:": "🛁",
  ":shower:": "🚿",
  ":toilet:": "🚽",
  ":wrench:": "🔧",
  ":nut_and_bolt:": "🔩",
  ":hammer:": "🔨",
  ":seat:": "💺",
  ":moneybag:": "💰",
  ":yen:": "💴",
  ":dollar:": "💵",
  ":pound:": "💷",
  ":euro:": "💶",
  ":credit_card:": "💳",
  ":money_with_wings:": "💸",
  ":e-mail:": "📧",
  ":inbox_tray:": "📥",
  ":outbox_tray:": "📤",
  ":envelope:": "✉️",
  ":incoming_envelope:": "📨",
  ":postal_horn:": "📯",
  ":mailbox_closed:": "📪",
  ":mailbox_with_mail:": "📬",
  ":mailbox_with_no_mail:": "📭",
  ":door:": "🚪",
  ":smoking:": "🚬",
  ":bomb:": "💣",
  ":gun:": "🔫",
  ":hocho:": "🔪",
  ":pill:": "💊",
  ":syringe:": "💉",
  ":page_facing_up:": "📄",
  ":page_with_curl:": "📃",
  ":bookmark_tabs:": "📑",
  ":bar_chart:": "📊",
  ":chart_with_upwards_trend:": "📈",
  ":chart_with_downwards_trend:": "📉",
  ":scroll:": "📜",
  ":clipboard:": "📋",
  ":calendar:": "📆",
  ":date:": "📅",
  ":card_index:": "📇",
  ":file_folder:": "📁",
  ":open_file_folder:": "📂",
  ":scissors:": "✂️",
  ":pushpin:": "📌",
  ":paperclip:": "📎",
  ":black_nib:": "✒️",
  ":pencil2:": "✏️",
  ":straight_ruler:": "📏",
  ":triangular_ruler:": "📐",
  ":closed_book:": "📕",
  ":green_book:": "📗",
  ":blue_book:": "📘",
  ":orange_book:": "📙",
  ":notebook:": "📓",
  ":notebook_with_decorative_cover:": "📔",
  ":ledger:": "📒",
  ":books:": "📚",
  ":bookmark:": "🔖",
  ":name_badge:": "📛",
  ":microscope:": "🔬",
  ":telescope:": "🔭",
  ":newspaper:": "📰",
  ":football:": "🏈",
  ":basketball:": "🏀",
  ":soccer:": "⚽",
  ":baseball:": "⚾",
  ":tennis:": "🎾",
  ":8ball:": "🎱",
  ":rugby_football:": "🏉",
  ":bowling:": "🎳",
  ":golf:": "⛳",
  ":mountain_bicyclist:": "🚵",
  ":bicyclist:": "🚴",
  ":horse_racing:": "🏇",
  ":snowboarder:": "🏂",
  ":swimmer:": "🏊",
  ":surfer:": "🏄",
  ":ski:": "🎿",
  ":spades:": "♠️",
  ":hearts:": "♥️",
  ":clubs:": "♣️",
  ":diamonds:": "♦️",
  ":gem:": "💎",
  ":ring:": "💍",
  ":trophy:": "🏆",
  ":musical_score:": "🎼",
  ":musical_keyboard:": "🎹",
  ":violin:": "🎻",
  ":space_invader:": "👾",
  ":video_game:": "🎮",
  ":black_joker:": "🃏",
  ":flower_playing_cards:": "🎴",
  ":game_die:": "🎲",
  ":dart:": "🎯",
  ":mahjong:": "🀄",
  ":clapper:": "🎬",
  ":memo:": "📝",
  ":pencil:": "📝",
  ":book:": "📖",
  ":art:": "🎨",
  ":microphone:": "🎤",
  ":headphones:": "🎧",
  ":trumpet:": "🎺",
  ":saxophone:": "🎷",
  ":guitar:": "🎸",
  ":shoe:": "👞",
  ":sandal:": "👡",
  ":high_heel:": "👠",
  ":lipstick:": "💄",
  ":boot:": "👢",
  ":shirt:": "👕",
  ":tshirt:": "👕",
  ":necktie:": "👔",
  ":womans_clothes:": "👚",
  ":dress:": "👗",
  ":running_shirt_with_sash:": "🎽",
  ":jeans:": "👖",
  ":kimono:": "👘",
  ":bikini:": "👙",
  ":ribbon:": "🎀",
  ":tophat:": "🎩",
  ":crown:": "👑",
  ":womans_hat:": "👒",
  ":mans_shoe:": "👞",
  ":closed_umbrella:": "🌂",
  ":briefcase:": "💼",
  ":handbag:": "👜",
  ":pouch:": "👝",
  ":purse:": "👛",
  ":eyeglasses:": "👓",
  ":fishing_pole_and_fish:": "🎣",
  ":coffee:": "☕",
  ":tea:": "🍵",
  ":sake:": "🍶",
  ":baby_bottle:": "🍼",
  ":beer:": "🍺",
  ":beers:": "🍻",
  ":cocktail:": "🍸",
  ":tropical_drink:": "🍹",
  ":wine_glass:": "🍷",
  ":fork_and_knife:": "🍴",
  ":pizza:": "🍕",
  ":hamburger:": "🍔",
  ":fries:": "🍟",
  ":poultry_leg:": "🍗",
  ":meat_on_bone:": "🍖",
  ":spaghetti:": "🍝",
  ":curry:": "🍛",
  ":fried_shrimp:": "🍤",
  ":bento:": "🍱",
  ":sushi:": "🍣",
  ":fish_cake:": "🍥",
  ":rice_ball:": "🍙",
  ":rice_cracker:": "🍘",
  ":rice:": "🍚",
  ":ramen:": "🍜",
  ":stew:": "🍲",
  ":oden:": "🍢",
  ":dango:": "🍡",
  ":egg:": "🥚",
  ":bread:": "🍞",
  ":doughnut:": "🍩",
  ":custard:": "🍮",
  ":icecream:": "🍦",
  ":ice_cream:": "🍨",
  ":shaved_ice:": "🍧",
  ":birthday:": "🎂",
  ":cake:": "🍰",
  ":cookie:": "🍪",
  ":chocolate_bar:": "🍫",
  ":candy:": "🍬",
  ":lollipop:": "🍭",
  ":honey_pot:": "🍯",
  ":apple:": "🍎",
  ":green_apple:": "🍏",
  ":tangerine:": "🍊",
  ":lemon:": "🍋",
  ":cherries:": "🍒",
  ":grapes:": "🍇",
  ":watermelon:": "🍉",
  ":strawberry:": "🍓",
  ":peach:": "🍑",
  ":melon:": "🍈",
  ":banana:": "🍌",
  ":pear:": "🍐",
  ":pineapple:": "🍍",
  ":sweet_potato:": "🍠",
  ":eggplant:": "🍆",
  ":tomato:": "🍅",
  ":corn:": "🌽",
  ":house:": "🏠",
  ":house_with_garden:": "🏡",
  ":school:": "🏫",
  ":office:": "🏢",
  ":post_office:": "🏣",
  ":hospital:": "🏥",
  ":bank:": "🏦",
  ":convenience_store:": "🏪",
  ":love_hotel:": "🏩",
  ":hotel:": "🏨",
  ":wedding:": "💒",
  ":church:": "⛪",
  ":department_store:": "🏬",
  ":european_post_office:": "🏤",
  ":city_sunrise:": "🌇",
  ":city_sunset:": "🌆",
  ":japanese_castle:": "🏯",
  ":european_castle:": "🏰",
  ":tent:": "⛺",
  ":factory:": "🏭",
  ":tokyo_tower:": "🗼",
  ":gamepad:": "🎮",
  ":dart:": "🎯",
  ":mahjong:": "🀄",
  ":chart:": "💹",
  ":currency_exchange:": "💱",
  ":x:": "❌",
  ":o:": "⭕",
  ":recycle:": "♻️",
  ":white_check_mark:": "✅",
  ":eight_spoked_asterisk:": "✳️",
  ":eight_pointed_black_star:": "✴️",
  ":heart_decoration:": "💟",
  ":vs:": "🆚",
  ":vibration_mode:": "📳",
  ":mobile_phone_off:": "📴",
  ":clock:": "🕰️",
  ":hourglass:": "⌛",
  ":hourglass_flowing_sand:": "⏳",
  ":alarm_clock:": "⏰",
  ":watch:": "⌚",
  ":game:": "🎮",
  ":compass:": "🧭",
  ":atm:": "🏧",
  ":put_litter_in_its_place:": "🚮",
  ":potable_water:": "🚰",
  ":mens:": "🚹",
  ":womens:": "🚺",
  ":restroom:": "🚻",
  ":baby_symbol:": "🚼",
  ":wc:": "🚾",
  ":passport_control:": "🛂",
  ":customs:": "🛃",
  ":baggage_claim:": "🛄",
  ":left_luggage:": "🛅",
  ":warning:": "⚠️",
  ":children_crossing:": "🚸",
  ":no_entry:": "⛔",
  ":no_entry_sign:": "🚫",
  ":no_bicycles:": "🚳",
  ":no_smoking:": "🚭",
  ":do_not_litter:": "🚯",
  ":non-potable_water:": "🚱",
  ":no_pedestrians:": "🚷",
  ":no_mobile_phones:": "📵",
  ":underage:": "🔞",
  ":radioactive:": "☢️",
  ":movie:": "🎦",
};


    function getData() {
      const url = './data.json';
      fetch(url)
        .then(response => response.json())
        .then(data => {
          console.log(data);
          main(data);
        })
        .catch(error => console.error(error));

    }

    function renderAnswer(data) {
        // if data.answer is a string
     if (typeof data.answer === 'object') {
        // if data.answer is an object

        // hide the description
        description.style.display = 'none';

      answers.innerHTML = Object.entries(data.answer).map(([key, value]) => {
        return `
                <div class="mb-2">
                    <h4 class="text-lg font-semibold">${key}</h4>
                    <p class="text-gray-500">${value}</p>
                </div>
            `;
      }).join('');
    } else  if (typeof data.answer === 'string') {
      console.log(data.answer);
        description.innerText = data.answer;

        // hide the answers
        answers.style.display = 'none';
    }
    }

    function renderSections(data) {
      
      sections.innerHTML = data.sections.map((section, index) => {
        return `
                <div class="mb-2">
                    <h4 class="text-lg font-semibold">${data.headings[index]}</h4>
                    <ul class="list-disc list-inside text-gray-500">
                        ${Object.entries(section).map(([key, value]) => {
          return `<li><strong>${key}</strong>: ${value}</li>`;
        }).join('')}
                    </ul>
                </div>
            `;
      }).join('');
    }

    function renderSources(data) {
      // render the sourceIcons
      sourceIcons.innerHTML = data.sources.map((source) => {
        return `<img src="https://www.google.com/s2/favicons?domain=${source.url}" alt="${source.url}" class="w-6 h-6 rounded-full" />`;
      }).join('');
      // add show sources button
      sourceIcons.innerHTML += `<button class="btn btn-ghost btn-sm" onclick="document.getElementById('sources').classList.toggle('hidden')">Show sources</button>`;	

      // render the sources
      sources.innerHTML = data.sources.map((source) => {
        let host = new URL(source.url).host;
        // remove www from the host
        host = host.replace('www.', '');
        return `
                <div class="carousel-item bg-gray-900 p-4 rounded-lg w-48 mx-1">
                    <div class="flex flex-col space-y-2">
                        <h4 class="font-semibold">${source.title}</h4>
                        <a href="${source.url}" target="_blank" class="text-blue-500 inline-flex"><img src="https://www.google.com/s2/favicons?domain=${source.url}" alt="${host}" class="w-5 h-5 rounded-full mr-2" /> ${host}</a>
                    </div>
                </div>
            `;
      }).join('');
    }

    function renderContent(data) {
      try {
        title.innerText = data.title;
      } catch (error) {
        console.error(error);
      }

      try {
        renderImages(data);
      } catch (error) {
        console.error(error);
      }
  
      try {
       renderAnswer(data);
      } catch (error) {
        console.error(error);
      }

      try {
        renderSections(data);
      } catch (error) {
        console.error(error);
      }

      try {
        renderSources(data);
      } catch (error) {
        console.error(error);
      }
    }

    function renderImages(data) {
      images.innerHTML = data.imageUrls.map((image) => {
        return `
                <div class="carousel-item h-80 w-auto">
                    <img class="object-contain" src="${image.image}" alt="${image.title}" onclick="window.open('${image.url}', '_blank')" title="${image.title}" height="100%" width="100%" onerror="this.parentElement.remove();" />
                </div>
            `;
      }).join('');

    }



    function main(data) {

      // loop through the data and replace the emojis with the actual emojis
      // convert json to string
      let dataString = JSON.stringify(data);
      // loop through the emojis and replace them with the actual emojis
      for (const [key, value] of Object.entries(emojis)) {
        dataString = dataString.replace(new RegExp(key, 'g'), value);
      }
      // convert the string back to json
      data = JSON.parse(dataString);

      renderContent(data);
    }

    function init() {
      // get the q parameter from the url, e.g. ?q=apple
      const urlParams = new URLSearchParams(window.location.search);
      let q = urlParams.get('q');

      console.log(q);
      if (q) {
        // make each word in the query a title case
        q = q.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
        title.innerText = q;
      }


      getData();
    }

    init();
  </script>

</body>

</html>